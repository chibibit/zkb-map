{"version":3,"sources":["glow.png","utils/theme.ts","utils/geometry.ts","Points.tsx","utils/scaling.ts","Stars.tsx","Flares.tsx","KillmailTicker.tsx","hooks/configuration.ts","hooks/connection.ts","hooks/killmails.ts","hooks/solarSystems.ts","DevTools.tsx","Controls.tsx","Camera.tsx","Effects.tsx","App.tsx","utils/fontawesome.ts","index.tsx"],"names":["module","exports","theme","background","colorMaxSec","colorMinSec","flare","text","unit","gapSize","buildAttributes","count","positions","Float32Array","colors","scales","setAttributes","geometry","setAttribute","THREE","attributes","position","needsUpdate","flareColor","size","tempVector","positionToArray","target","index","x","y","z","toArray","flareTexture","load","glow","uniforms","color","value","pointTexture","Points","forwardRef","_props","ref","attach","vertexShader","fragmentShader","blending","depthTest","transparent","ageMultiplier","age","scale","smoothstep","fullyInvisibleMs","t","Math","pow","scaleValue","normalized","clamp","mapLinear","useMinViewportSize","useThree","height","width","min","React","memo","solarSystems","pointsRef","useRef","useContext","ThemeContext","minViewportSize","useFrame","current","solarSystemArray","Object","values","length","systemSize","solarSystem","lerp","security","radius","killmails","now","Date","baseFlareSize","colorFlare","receivedAt","solarSystemId","scaledValue","differenceInMilliseconds","CameraMode","TickerContainer","styled","div","EntryContainer","animated","ImageLink","a","area","Image","src","href","img","style","alt","KillmailEntry","killmail","characterId","corporationId","allianceId","shipTypeId","url","useSpring","opacity","paddingBottom","set","useEffect","animate","config","duration","interval","setInterval","clearInterval","gridAutoRows","KillmailTicker","entries","map","km","key","id","useConnection","create","connected","pingReceived","undefined","receivePing","checkConnection","shouldKeep","subscribeMessage","channel","JSON","stringify","useKillmails","receiveKillmail","state","trimKillmails","shouldKeepNow","bind","pickBy","useKillmailMonitor","sourceUrl","useCallback","connection","WebSocket","onopen","send","onmessage","e","parsed","parse","data","raw","killmail_id","killmail_time","victim","solar_system_id","zkb","character_id","corporation_id","alliance_id","ship_type_id","totalValue","time","parseISO","parseKillmail","console","error","onclose","close","useConfiguration","cameraMode","full","setCameraMode","mode","useSolarSystems","systems","regions","loaded","receive","reduce","region","n","parseInt","name","system","r","s","p","regionId","selectLoaded","selectReceive","getTime","Container","FlatButton","button","onClick","FullscreenToggle","useState","fullScreen","setFullScreen","type","title","document","exitFullscreen","then","getElementById","requestFullscreen","icon","ConnectionStatus","cameraIcon","follow","nextCameraModes","cameraTitles","CameraStatus","update","Controls","defaultPosition","minRadius","Camera","points","computeBoundingSphere","boundingSphere","center","max","lookAtPoints","maxX","Infinity","maxY","maxZ","minX","minY","minZ","totalX","totalY","totalZ","totalScale","scaledX","scaledY","scaledZ","makeDefault","near","far","fov","Effects","multisampling","luminanceThreshold","luminanceSmoothing","intensity","eskil","offset","darkness","GlobalStyle","createGlobalStyle","reset","TopLeft","TopRight","Visuals","onCreated","gl","setClearColor","Provider","App","abortController","AbortController","fetch","signal","res","json","abort","useSolarSystemData","process","useConnectionStatus","killmailsRef","inCurrentSystems","arr","push","sortBy","reverse","library","add","faCompressArrowsAlt","faExpandArrowsAlt","faLink","faUnlink","faVideo","faGlobe","Component","ReactDOM","render","StrictMode"],"mappings":"6FAAAA,EAAOC,QAAU,IAA0B,kC,oJCA9BC,EAAQ,CACnBC,WAAY,UACZC,YAAa,UACbC,YAAa,UACbC,MAAO,UACPC,KAAM,UACNC,KAAM,GACNC,QAAS,G,OCLEC,EAAkB,SAACC,GAAD,MAAoB,CACjDC,UAAW,IAAIC,aAAqB,EAARF,GAC5BG,OAAQ,IAAID,aAAqB,EAARF,GACzBI,OAAQ,IAAIF,aAAaF,KAGdK,EAAgB,SAACC,EAAgCL,EAAyBE,EAAsBC,GAC3GE,EAASC,aAAa,WAAY,IAAIC,kBAAsBP,EAAW,IACvEK,EAASC,aAAa,aAAc,IAAIC,kBAAsBL,EAAQ,IACtEG,EAASC,aAAa,OAAQ,IAAIC,kBAAsBJ,EAAQ,IAEhEE,EAASG,WAAWC,SAASC,aAAc,EAC3CL,EAASG,WAAWG,WAAWD,aAAc,EAC7CL,EAASG,WAAWI,KAAKF,aAAc,GASnCG,EAAa,IAAIN,UACVO,EAAkB,SAAC,EAA0BC,EAAsBC,GAAyB,IAAvEC,EAAsE,EAAtEA,EAAGC,EAAmE,EAAnEA,EAAGC,EAAgE,EAAhEA,EACtCN,EAAWI,EAAIA,EACfJ,EAAWK,EAAIA,EACfL,EAAWM,EAAIA,EACfN,EAAWO,QAAQL,EAAgB,EAARC,I,kBCCvBK,GAAe,IAAId,iBAAsBe,KAAKC,KAE9CC,EAAW,CACfC,MAAO,CAAEC,MAAO,IAAInB,SACpBoB,aAAc,CAAED,MAAOL,IAgBVO,EAbAC,sBAAW,SAACC,EAAQC,GAAT,OAAiB,4BAAQA,IAAKA,GACtD,oCAAgBC,OAAO,aACvB,oCACER,SAAUA,EACVS,aArCe,4SAsCfC,eAxBiB,6OAyBjBC,SAAU5B,mBACV6B,WAAW,EACXC,aAAa,EACbL,OAAO,iBCxCEM,EAAgB,SAACC,EAAaC,GACzC,GAAID,EAHgC,IAIlC,OAAOhC,YAAgBkC,WAAWF,EAAK,EAJL,KAMlC,IAAMG,EAPyB,KAOgBF,EACzCG,EAAIpC,YAAgBkC,WAAWF,EAPH,IAOgCG,GAAoB,EACtF,OAAOE,KAAKC,IAAIF,EAAG,IASVG,EAAa,SAACpB,GACzB,IAAMqB,EAAaxC,YAAgByC,MAAMtB,EANrB,IACA,MAMpB,OAAOnB,YAAgB0C,UAAUF,EAPb,IACA,KACK,EACA,KAOdG,EAAqB,WAAO,IAAD,EACFC,cAA5BvC,KAAQwC,EADsB,EACtBA,OAAQC,EADc,EACdA,MAIxB,OAFgBT,KAAKU,IAAIF,EAAQC,ICoBpBE,MAAMC,MArChB,SAAC,GAAsB,IAApBC,EAAmB,EAAnBA,aACAC,EAAYC,mBAEZrE,EAAQsE,qBAAWC,KAEnBC,EAAkBZ,IA6BxB,OA3BAa,aAAS,WACP,GAAKL,EAAUM,QAAf,CAaA,IATA,IAAMxE,EAAc,IAAIe,QAAYjB,EAAME,aACpCyE,EAAmBC,OAAOC,OAAOV,GAEjC1D,EAAQkE,EAAiBG,OAEzBC,EAAaP,EArBO,GAWb,EAYyBhE,EAAgBC,GAA9CC,EAZK,EAYLA,UAAWE,EAZN,EAYMA,OAAQC,EAZd,EAYcA,OAElBa,EAAQ,EAAGA,EAAQjB,EAAOiB,IAAS,CAC1C,IAAMsD,EAAcL,EAAiBjD,GAErCF,EAAgBwD,EAAatE,EAAWgB,GAExC,IAAIT,QAAYjB,EAAMG,aAAa8E,KAAK/E,EAAa8E,EAAYE,UAAUpD,QAAQlB,EAAgB,EAARc,GAE3Fb,EAAOa,GAASqD,EAAaC,EAAYG,OAG3CrE,EAAcsD,EAAUM,QAAQ3D,SAAkCL,EAAWE,EAAQC,OAGhF,kBAAC,EAAD,CAAQ4B,IAAK2B,O,QCKPH,MAAMC,MAvChB,SAAC,GAAiC,IAA/BC,EAA8B,EAA9BA,aAAciB,EAAgB,EAAhBA,UACdhB,EAAYC,mBAEZrE,EAAQsE,qBAAWC,KAEnBC,EAAkBZ,IA+BxB,OA7BAa,aAAS,WACP,GAAKW,EAAUV,SAAYN,EAAUM,QAArC,CAYA,IARA,IAAMjE,EAAQ2E,EAAUV,QAAQI,OAE1BO,EAAM,IAAIC,KACVC,EAAgBf,EAAkB,EAClCgB,EAAa,IAAIvE,QAAYjB,EAAMI,OAT5B,EAWyBI,EAAgBC,GAA9CC,EAXK,EAWLA,UAAWE,EAXN,EAWMA,OAAQC,EAXd,EAWcA,OAElBa,EAAQ,EAAGA,EAAQ0D,EAAUV,QAAQI,OAAQpD,IAAS,CAAC,IAAD,EACV0D,EAAUV,QAAQhD,GAA7D+D,EADqD,EACrDA,WAAYC,EADyC,EACzCA,cAAeC,EAD0B,EAC1BA,YAE7BX,EAAcb,EAAauB,IAAkB,GAE7CzC,EAAM2C,YAAyBP,EAAKI,GAC1C5E,EAAOa,GAAS6D,EAAgBI,EAAc3C,EAAcC,EAAK0C,GAEjEnE,EAAgBwD,EAAatE,EAAWgB,GAExC8D,EAAW1D,QAAQlB,EAAgB,EAARc,GAG7BZ,EAAcsD,EAAUM,QAAQ3D,SAAkCL,EAAWE,EAAQC,OAGhF,kBAAC,EAAD,CAAQ4B,IAAK2B,O,miBCzCtB,ICLYyB,EDKNC,EAAkBC,IAAOC,IAAV,KAEQ,qBAAGhG,MAAkBM,QAK5C2F,EAAiBF,YAAOG,IAASF,IAAhBD,CAAH,KAGG,qBAAG/F,MAAkBM,QACxB,qBAAGN,MAAkBM,QAChC,qBAAGN,MAAkBO,WACV,qBAAGP,MAAkBO,WAGnC4F,EAAYJ,IAAOK,EAAV,KACA,qBAAGC,QAIZC,EAMD,SAAC,GAAuC,IAArCC,EAAoC,EAApCA,IAAKF,EAA+B,EAA/BA,KAAMG,EAAyB,EAAzBA,KAAM1C,EAAmB,EAAnBA,OAAQxC,EAAW,EAAXA,KAC/B,OAAO,kBAAC6E,EAAD,CAAWK,KAAMA,EAAMH,KAAMA,EAAM5E,OAAO,UAC/C,kBAAC,IAASgF,IAAV,CACEF,IAAG,UAAKA,EAAL,iBAAiBjF,GACpBoF,MAAO,CAAE5C,SAAQC,MAAOzC,GACxBqF,IAAI,OAQJC,EAED3C,IAAMC,MAAK,YAAmB,IAAhB2C,EAAe,EAAfA,SACTvG,EAASgE,qBAAWC,KAApBjE,KACAwG,EAAqFD,EAArFC,YAAaC,EAAwEF,EAAxEE,cAAeC,EAAyDH,EAAzDG,WAAYC,EAA6CJ,EAA7CI,WAAYC,EAAiCL,EAAjCK,IAAKzB,EAA4BoB,EAA5BpB,WAAYE,EAAgBkB,EAAhBlB,YAF7C,EAIkBwB,aAAU,iBAAO,CAAEC,QAAS,EAAGtD,OAAQ,EAAGuD,cAAe,MAJ3E,0BAIvBvD,EAJuB,EAIvBA,OAAQuD,EAJe,EAIfA,cAAeD,EAJA,EAIAA,QAAWE,EAJX,KA4BhC,OAtBAC,qBAAU,WACR,IAAMzD,EAASxD,EACT+G,EAAgB/G,EAAO,EACvBkH,EAAU,WACd,IAAMvE,EAAM2C,YAAyB,IAAIN,KAAQG,GACjD,GAAIxC,EHxD4B,IGyD9BqE,EAAI,CAAEF,QAAS,EAAGtD,SAAQuD,gBAAeI,OAAQ,CAAEC,SAhBjC,WAiBb,CACL,IAAMN,EAAUpE,EAAcC,EAAK0C,GAEjC2B,EADEF,EAAU,GACR,CAAEA,UAAStD,SAAQuD,gBAAeI,OAAQ,CAAEC,SArB9B,MAuBd,CAAEN,QAAS,EAAGtD,OAAQ,EAAGuD,cAAe,EAAGI,OAAQ,CAAEC,SAtBzC,SA2BhBC,EAAWC,YAAYJ,EA5BL,KA8BxB,OADAA,IACO,kBAAMK,cAAcF,MAC1B,CAACL,EAAK7B,EAAYE,EAAarF,IAE3B,kBAAC2F,EAAD,CAAgBS,MAAO,CAAEU,UAASC,gBAAeS,aAAchE,IACnEmD,GAAc,kBAAC,EAAD,CACbV,IAAG,2CAAsCU,EAAtC,WACHZ,KAAK,OACLvC,OAAQA,EACR0C,KAAMU,EACN5F,KAAMhB,IAEPwG,GAAe,kBAAC,EAAD,CACdP,IAAG,gDAA2CO,EAA3C,aACHT,KAAK,YACLvC,OAAQA,EACR0C,KAAI,2CAAsCM,EAAtC,KACJxF,KAAMhB,IAEPyG,GAAiB,kBAAC,EAAD,CAChBR,IAAG,kDAA6CQ,EAA7C,SACHV,KAAK,cACLvC,OAAQA,EACR0C,KAAI,6CAAwCO,EAAxC,KACJzF,KAAMhB,IAEP0G,GAAc,kBAAC,EAAD,CACbT,IAAG,+CAA0CS,EAA1C,SACHX,KAAK,WACLvC,OAAQA,EACR0C,KAAI,0CAAqCQ,EAArC,KACJ1F,KAAMhB,QAeGyH,EARV,SAAC,GAAmB,IACjBC,EADgB,EAAhB5C,UACoB6C,KAAI,SAAAC,GAAE,OAAI,kBAACtB,EAAD,CAAeC,SAAUqB,EAAIC,IAAKD,EAAGE,QAEzE,OAAO,kBAACtC,EAAD,KACJkC,I,kDErGQK,EAAgBC,aAAc,SAAAhB,GAAG,MAAK,CACjDiB,WAAW,EACXC,kBAAcC,EACdC,YAAa,kBAAMpB,EAAI,CAAEiB,WAAW,EAAMC,aAAc,IAAIlD,QAC5DqD,gBAAiB,kBAAMrB,GAAI,YAAuB,IAApBkB,EAAmB,EAAnBA,aAE5B,MAAO,CAAED,YADSC,GAAe5C,YAAyB,IAAIN,KAAQkD,GAfrC,cCgD/BI,EAAa,SAACvD,EAAWwB,GAAwB,IAC7ClB,EAA4BkB,EAA5BlB,YAAaF,EAAeoB,EAAfpB,WAErB,OADYG,YAAyBP,EAAKI,GA9CT,KA+CEE,GAG/BkD,EAAmB,SAACC,GAAD,OAAqBC,KAAKC,UAAU,CAC3D,OAAU,MACV,QAAWF,KAwBAG,EAAeX,aAAc,SAAAhB,GAAG,MAAK,CAChDlC,UAAW,GACX8D,gBAAiB,SAACrC,GAAeS,GAAI,SAAA6B,GAAK,MAAK,CAAE/D,UAAU,eAAM+D,EAAM/D,UAAb,eAAyByB,EAASuB,GAAKvB,SACjGuC,cAAe,WACb,IAAMC,EAAgBT,EAAWU,UAAKb,EAAW,IAAInD,MACrDgC,GAAI,SAAA6B,GAAK,MAAK,CAAE/D,UAAWmE,IAAOJ,EAAM/D,UAAWiE,YAI1CG,EAAqB,SAACC,GACjC,IAAMf,EAAcL,EAAcqB,uBAAY,SAAAP,GAAK,OAAIA,EAAMT,cAAa,KACpEU,EAAgBH,EAAaS,uBAAY,SAAAP,GAAK,OAAIA,EAAMC,gBAAe,KACvEF,EAAkBD,EAAaS,uBAAY,SAAAP,GAAK,OAAIA,EAAMD,kBAAiB,KAEjF3B,qBAAU,WACR,IAAMI,EAAWC,YAAYwB,EA1FV,KA2FnB,OAAO,kBAAMvB,cAAcF,MAC1B,CAACyB,IAEJ7B,qBAAU,WACR,IAAMoC,EAAa,IAAIC,UAAUH,GAuBjC,OArBAE,EAAWE,OAAS,WAClBF,EAAWG,KAAKjB,EAAiB,eACjCc,EAAWG,KAAKjB,EAAiB,YAGnCc,EAAWI,UAAY,SAACC,GACtB,IAAMC,EAA2BlB,KAAKmB,MAAMF,EAAEG,MAE1C,gBAAiBF,EACnBf,EApDc,SAACkB,GAAsC,IACnDC,EAA6DD,EAA7DC,YAAaC,EAAgDF,EAAhDE,cAAeC,EAAiCH,EAAjCG,OAAQC,EAAyBJ,EAAzBI,gBAAiBC,EAAQL,EAARK,IACrDC,EAA4DH,EAA5DG,aAAcC,EAA8CJ,EAA9CI,eAAgBC,EAA8BL,EAA9BK,YAAaC,EAAiBN,EAAjBM,aAC3C3D,EAAoBuD,EAApBvD,IAAK4D,EAAeL,EAAfK,WAGb,MAAO,CACL1C,GAAIiC,EACJU,KAJWC,YAASV,GAKpB7E,WAAY,IAAIH,KAChBwB,YAAa4D,EACb3D,cAAe4D,EACf3D,WAAY4D,EACZ3D,WAAY4D,EACZnF,cAAe8E,EACftD,MACA4D,aACAnF,YAAanC,EAAWsH,IAmCJG,CAAchB,IACrB,aAAcA,EACvBvB,IAEAwC,QAAQC,MAAMlB,IAIlBN,EAAWyB,QAAU,SAACpB,GACpBkB,QAAQC,MAAMnB,IAGT,kBAAML,EAAW0B,WACvB,CAAC5B,EAAWP,EAAiBR,M,SF9HtB7C,O,eAAAA,I,oBAAAA,M,KAUL,IAAMyF,EAAmBhD,aAAc,SAAAhB,GAAG,MAAK,CACpDiE,WAAY1F,EAAW2F,KACvBC,cAAe,SAACC,GAAD,OAAUpE,EAAI,CAAEiE,WAAYG,S,sCGoBhCC,GAAkBrD,aAAc,SAAAhB,GAAG,MAAK,CACnDsE,QAAS,GACTC,QAAS,GACTC,QAAQ,EACRC,QAAS,SAAC5B,GACR,IAAM0B,EAAUG,IAAO7B,EAAK0B,SAAS,SAAC1C,EAAO8C,EAAQ7D,GAAQ,IACnDzG,EAAesK,EAAftK,EAAGC,EAAYqK,EAAZrK,EAAGC,EAASoK,EAATpK,EAAGqK,EAAMD,EAANC,EAQjB,OAPA/C,EAAMf,GAAM,CACVA,GAAI+D,SAAS/D,GACbzG,IACAC,EAAGC,EACHA,EAAGD,EACHwK,KAAMF,GAED/C,IACN,IAEGyC,EAAUI,IAAO7B,EAAKyB,SAAS,SAACzC,EAAOkD,EAAQjE,GAAQ,IACnDzG,EAAwB0K,EAAxB1K,EAAGC,EAAqByK,EAArBzK,EAAGC,EAAkBwK,EAAlBxK,EAAGqK,EAAeG,EAAfH,EAAGI,EAAYD,EAAZC,EAAGC,EAASF,EAATE,EAAGC,EAAMH,EAANG,EAW1B,OAVArD,EAAMf,GAAM,CACVA,GAAI+D,SAAS/D,GACbzG,IACAC,EAAGC,EACHA,EAAGD,EACHwK,KAAMF,EACN/G,OAAQzB,KAAU,IAAJ4I,EAAS,GAAK,KAC5BpH,SAAUqH,EACVE,SAAUD,GAELrD,IACN,IAEH7B,EAAI,CAAEuE,UAASD,UAASE,QAAQ,SAI9BY,GAAe,SAACvD,GAAD,OAAkBA,EAAM2C,QACvCa,GAAgB,SAACxD,GAAD,OAAkBA,EAAM4C,S,mKC/D5BhG,IAAOC,IAAV,MACJ,qBAAGhG,MAAkBK,SASnB,IAAIiF,MAAOsH,UAVxB,I,qbCFA,IAAMC,GAAY9G,IAAOC,IAAV,MACJ,qBAAGhG,MAAkBK,QAGT,qBAAGL,MAAkBM,QACxB,qBAAGN,MAAkBM,QAChC,qBAAGN,MAAkBO,WAIxBuM,GAAa/G,IAAOgH,OAAV,MACL,qBAAG/M,MAAkBK,QAGjB,qBAAGgG,QACN,qBAAG2G,QAAwB,UAAY,aAG7CC,GAA6B,WAAO,IAAD,EACHC,oBAAS,GADN,mBAChCC,EADgC,KACpBC,EADoB,KAWvC,OAAO,kBAACN,GAAD,CAAYO,KAAK,SAASC,MAAOH,EAAa,kBAAoB,gBAAiBH,QAR1E,WAGN,IAAD,EAFHG,EACFI,SAASC,iBAAiBC,MAAK,kBAAML,GAAc,MAEnD,UAAAG,SAASG,eAAe,eAAxB,SAAiCC,oBAAoBF,MAAK,kBAAML,GAAc,OAI0B/G,KAAK,cAC/G,kBAAC,KAAD,CAAiBuH,KAAMT,EAAa,sBAAwB,wBAI1DU,GAA6B,WACjC,IAAMtF,EAAYF,EAAcqB,uBAAY,SAAAP,GAAK,OAAIA,EAAMZ,YAAW,KAEtE,OAAO,kBAACuE,GAAD,CAAYO,KAAK,SAASC,MAAO/E,EAAY,yBAA2B,+BAAgClC,KAAK,cAClH,kBAAC,KAAD,CAAiBuH,KAAMrF,EAAY,OAAS,aAI1CuF,IAA4D,qBAC/DjI,EAAW2F,KAAO,SAD6C,eAE/D3F,EAAWkI,OAAS,SAF2C,IAK5DC,IAA+C,qBAClDnI,EAAW2F,KAAO3F,EAAWkI,QADqB,eAElDlI,EAAWkI,OAASlI,EAAW2F,MAFmB,IAK/CyC,IAAwC,qBAC3CpI,EAAW2F,KAAO,qBADyB,eAE3C3F,EAAWkI,OAAS,6BAFuB,IAMxCG,GAAyB,WAC7B,IAAMxC,EAAOJ,EAAiB5B,uBAAY,SAAAP,GAAK,OAAIA,EAAMoC,aAAY,KAC/D4C,EAAS7C,EAAiB5B,uBAAY,SAAAP,GAAK,OAAIA,EAAMsC,gBAAe,KAO1E,OAAO,kBAACqB,GAAD,CAAYO,KAAK,SAASC,MAAOW,GAAavC,GAAOsB,QAL5C,WAEdmB,EADuBH,GAAgBtC,KAIqCrF,KAAK,UACjF,kBAAC,KAAD,CAAiBuH,KAAME,GAAWpC,OAYvB0C,GARY,WACzB,OAAO,kBAAC,GAAD,KACL,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,QCpEEC,GAAkB,IAAIpN,UAAc,EAAG,EAAG,KAE1CqN,GAAYD,GAAgBxM,EAAI,EAkIvB0M,GApGVtK,IAAMC,MAAK,YAAkC,IAA/BC,EAA8B,EAA9BA,aAAciB,EAAgB,EAAhBA,UACzBsG,EAAOJ,EAAiB5B,uBAAY,SAAAP,GAAK,OAAIA,EAAMoC,aAAY,KAC/D9I,EAAM4B,mBACNlD,EAAWkD,iBAAOgK,IAsFxB,OApFA9G,qBAAU,WACR,IAAM5C,EAAmBC,OAAOC,OAAOV,GACnCQ,EAAiBG,OAAS,IAC5B3D,EAASuD,QAnCM,SAAC8J,GAKpB,IAJA,IAAM/N,EAAQ+N,EAAO1J,OAEfpE,EAAY,IAAIC,aAAqB,EAARF,GAE1BiB,EAAQ,EAAGA,EAAQjB,EAAOiB,IACjCF,EAAgBgN,EAAO9M,GAAQhB,EAAWgB,GAG5C,IAAMX,EAAW,IAAIE,iBAKrB,GAHAF,EAASC,aAAa,WAAY,IAAIC,kBAAsBP,EAAW,IAEvEK,EAAS0N,wBACL1N,EAAS2N,eAAgB,CAAC,IAAD,EACA3N,EAAS2N,eAA5BC,EADmB,EACnBA,OAAQxJ,EADW,EACXA,OAGhB,OADAwJ,EAAO9M,GAAKyB,KAAKsL,IAAa,IAATzJ,EAAcmJ,IAC5BK,EAEP,OAAON,GAecQ,CAAalK,GAC5BlC,EAAIiC,SACNjC,EAAIiC,QAAQvD,SAAS8D,KAAK9D,EAASuD,QAAS,MAG/C,CAACP,IAEJM,aAAS,WACP,GAAIhC,EAAIiC,SAAWvD,EAASuD,QAAS,CAAC,IAAD,EAC/BjD,EAASN,EAASuD,QAEhBjE,GAAQ,UAAA2E,EAAUV,eAAV,eAAmBI,SAAU,EAE3C,GAAIrE,EAAQ,GAAKiL,IAAS7F,EAAWkI,OAAQ,CAiB3C,IAhBA,IAAM1I,EAAM,IAAIC,KAEZwJ,GAAQC,IACRC,GAAQD,IACRE,GAAQF,IAERG,EAAQH,IACRI,EAAQJ,IACRK,EAAQL,IAERM,EAAS,EACTC,EAAS,EACTC,EAAS,EAETC,EAAa,EAER9N,EAAQ,EAAGA,EAAQjB,EAAOiB,IAAS,CAAC,IAAD,EACS0D,EAAUV,QAAQhD,GAA7DgE,EADkC,EAClCA,cAAeC,EADmB,EACnBA,YAAaF,EADM,EACNA,WADM,EAEtBtB,EAAauB,GAAzB/D,EAFkC,EAElCA,EAAGC,EAF+B,EAE/BA,EAAGC,EAF4B,EAE5BA,EAERoB,EAAM2C,YAAyBP,EAAKI,GACpCvC,EAAQyC,EAAc3C,EAAcC,EAAK0C,GAE/C,GAAIzC,EAAQ,GAAK,CACf,IAAMuM,EAAUvM,EAAQvB,EAClB+N,EAAUxM,EAAQtB,EAClB+N,EAAUzM,EAAQrB,EAExBiN,EAAOxL,KAAKsL,IAAIE,EAAMnN,GACtBqN,EAAO1L,KAAKsL,IAAII,EAAMpN,GACtBqN,EAAO3L,KAAKsL,IAAIK,EAAMpN,GAEtBqN,EAAO5L,KAAKU,IAAIkL,EAAMvN,GACtBwN,EAAO7L,KAAKU,IAAImL,EAAMvN,GACtBwN,EAAO9L,KAAKU,IAAIoL,EAAMvN,GAEtBwN,GAAUI,EACVH,GAAUI,EACVH,GAAUI,EAEVH,GAActM,GAIlB,GAAIsM,EAAa,EAAG,CAClB,IAAM7N,EAAI0N,EAASG,EACb5N,EAAI0N,EAASE,EACb3N,EAAI0N,EAASC,EAEbrK,EAAS7B,KAAKsL,IAClBE,EAAOnN,EACPqN,EAAOpN,EACPqN,EAAOpN,EACPF,EAAIuN,EACJtN,EAAIuN,EACJtN,EAAIuN,EACJd,IAGF7M,EAAS,IAAIR,UAAcU,EAAGC,EAAGC,EAAa,IAATsD,IAIzC1C,EAAIiC,QAAQvD,SAAS8D,KAAKxD,EAlHL,SAsHlB,oCACL,kBAAC,KAAD,CACEgB,IAAKA,EACLmN,aAAW,EACXC,KAjIO,KAkIPC,IAjIM,IAkINC,IAjIM,S,8BCCGC,GARW,WACxB,OAAO,kBAAC,KAAD,CAAgBC,cAHsC,GAI3D,kBAAC,KAAD,CAAOC,mBAAoB,GAAKC,mBAAoB,GAAKC,UAAW,IACpE,kBAAC,KAAD,CAAOhJ,QAAS,MAChB,kBAAC,KAAD,CAAUiJ,OAAO,EAAOC,OAAQ,GAAKC,SAAU,Q,scCOnD,IAEMC,GAAcC,YAAH,KACbC,KAIc,qBAAG1Q,MAAkBC,cASjC0Q,GAAU5K,IAAOC,IAAV,MAMP4K,GAAW7K,IAAOC,IAAV,MAMR6K,GAGD3M,gBAAK,YAAkC,IAA/BC,EAA8B,EAA9BA,aAAciB,EAAgB,EAAhBA,UACzB,OAAO,kBAAC,IAAD,CAAQ0L,UAAW,qBAAGC,GAAYC,cAAchR,EAAMC,cAC3D,kBAAC,IAAagR,SAAd,CAAuB7O,MAAOpC,GAC5B,uCAEA,kBAAC,EAAD,CAAOmE,aAAcA,IACrB,kBAAC,EAAD,CAAQA,aAAcA,EAAciB,UAAWA,IAE/C,kBAAC,GAAD,CAAQjB,aAAcA,EAAciB,UAAWA,IAE/C,kBAAC,GAAD,WA4CS8L,GAvCW,WACxB1H,EAAmB,mCLUa,SAACC,GACjC,IAAMqC,EAASH,GAAgBe,IACzBX,EAAUJ,GAAgBgB,IAEhCpF,qBAAU,WACR,IAAKuE,EAAQ,CACX,IAAMqF,EAAkB,IAAIC,gBAI5B,OAFAC,MAAM5H,EAAW,CAAE6H,OAAQH,EAAgBG,SAAU7D,MAAK,SAAA8D,GAAG,OAAIA,EAAIC,UAAQ/D,KAAK1B,GAE3E,kBAAMoF,EAAgBM,YAE9B,CAAChI,EAAWqC,EAAQC,IKrBvB2F,CAAmBC,wDPxCc,WACjC,IAAMhJ,EAAkBN,EAAcqB,uBAAY,SAAAP,GAAK,OAAIA,EAAMR,kBAAiB,KAElFpB,qBAAU,WACR,IAAMI,EAAWC,YAAYe,EAvBX,KAwBlB,OAAO,kBAAMd,cAAcF,MAC1B,CAACgB,IOmCJiJ,GAEA,IAAMC,EAAexN,iBAAmB,IAElCF,EAAewH,GAAgBjC,uBAAY,SAAAP,GAAK,OAAIA,EAAMyC,UAAS,KAEnExG,EAAY6D,EAAaS,uBAAY,SAAAP,GACzC,IAAM2I,EAAmB9F,IAAO7C,EAAM/D,WAAW,SAAC2M,EAAK7J,GAIrD,OAHI/D,EAAa+D,EAAGxC,gBAClBqM,EAAIC,KAAK9J,GAEJ6J,IACN,IACH,OAAOE,KAAOH,EAAkB,cAAcI,YAC7C,CAAC/N,KAMJ,OAJAoD,qBAAU,WACRsK,EAAanN,QAAUU,IACtB,CAACA,IAEG,kBAAC,IAAD,CAAepF,MAAOA,GAC3B,kBAACwQ,GAAD,MAEA,kBAACK,GAAD,CAAS1M,aAAcA,EAAciB,UAAWyM,IAEhD,kBAAClB,GAAD,KACE,kBAAC,EAAD,CAAgBvL,UAAWA,KAG7B,kBAACwL,GAAD,KACE,kBAAC,GAAD,OA/EUe,K,kBCXhBQ,KAAQC,IAAIC,KAAqBC,KAAmBC,KAAQC,KAAUC,KAASC,MCA/E,IAAgBC,MASTzB,GARL0B,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAACH,GAAD,OAEFpF,SAASG,eAAe,W","file":"static/js/main.dd0b6c55.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/glow.3b6b0c75.png\";","export const theme = {\n  background: '#060606',\n  colorMaxSec: '#2A9FD6',\n  colorMinSec: '#E6E6E6',\n  flare: '#E60000',\n  text: '#E6E6E6',\n  unit: 32,\n  gapSize: 8\n}\n\nexport type Theme = typeof theme\n\ndeclare module 'styled-components' {\n  export interface DefaultTheme extends Theme {}\n}\n","import * as THREE from 'three'\n\nexport const buildAttributes = (count: number) => ({\n  positions: new Float32Array(count * 3),\n  colors: new Float32Array(count * 3),\n  scales: new Float32Array(count)\n})\n\nexport const setAttributes = (geometry: THREE.BufferGeometry, positions: Float32Array, colors: Float32Array, scales: Float32Array) => {\n  geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3))\n  geometry.setAttribute('flareColor', new THREE.BufferAttribute(colors, 3))\n  geometry.setAttribute('size', new THREE.BufferAttribute(scales, 1))\n\n  geometry.attributes.position.needsUpdate = true\n  geometry.attributes.flareColor.needsUpdate = true\n  geometry.attributes.size.needsUpdate = true\n}\n\nexport interface HasPosition {\n x: number\n y: number\n z: number\n}\n\nconst tempVector = new THREE.Vector3()\nexport const positionToArray = ({ x, y, z }: HasPosition, target: Float32Array, index: number): void => {\n  tempVector.x = x\n  tempVector.y = y\n  tempVector.z = z\n  tempVector.toArray(target, index * 3)\n}\n\n","import React, { forwardRef } from 'react'\nimport * as THREE from 'three'\nimport glow from './glow.png'\n\nconst VERTEX_SHADER = `\n  attribute float size;\n  attribute vec3 flareColor;\n\n  varying vec3 vColor;\n\n  void main() {\n    vColor = flareColor;\n    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n    gl_PointSize = size * (300.0 / -mvPosition.z);\n    gl_Position = projectionMatrix * mvPosition;\n  }\n`\n\nconst FRAGMENT_SHADER = `\n  uniform vec3 color;\n  uniform sampler2D pointTexture;\n\n  varying vec3 vColor;\n\n  void main() {\n    gl_FragColor = vec4(color * vColor, 1.0);\n    gl_FragColor = gl_FragColor * texture2D( pointTexture, gl_PointCoord );\n  }\n`\n\nconst flareTexture = new THREE.TextureLoader().load(glow)\n\nconst uniforms = {\n  color: { value: new THREE.Color() },\n  pointTexture: { value: flareTexture }\n}\n\nconst Points = forwardRef((_props, ref) => <points ref={ref as any}>\n  <bufferGeometry attach='geometry' />\n  <shaderMaterial\n    uniforms={uniforms}\n    vertexShader={VERTEX_SHADER}\n    fragmentShader={FRAGMENT_SHADER}\n    blending={THREE.AdditiveBlending}\n    depthTest={false}\n    transparent={true}\n    attach='material'\n  />\n</points>)\n\nexport default Points\n","import * as THREE from 'three'\nimport { useThree } from 'react-three-fiber'\n\nexport const normalKillmailAgeMs = 45 * 1000\nexport const killmailFullyVisibleMs = 500\n\nexport const ageMultiplier = (age: number, scale: number): number => {\n  if (age < killmailFullyVisibleMs) {\n    return THREE.MathUtils.smoothstep(age, 0, killmailFullyVisibleMs)\n  } else {\n    const fullyInvisibleMs = normalKillmailAgeMs * scale\n    const t = THREE.MathUtils.smoothstep(age, killmailFullyVisibleMs, fullyInvisibleMs) - 1\n    return Math.pow(t, 4)\n  }\n}\n\nconst minValueBound = 10_000\nconst maxValueBound = 10_000_000_000\nconst minValueMultiplier = 1\nconst maxValueMultiplier = 10\n\nexport const scaleValue = (value: number): number => {\n  const normalized = THREE.MathUtils.clamp(value, minValueBound, maxValueBound)\n  return THREE.MathUtils.mapLinear(normalized, minValueBound, maxValueBound, minValueMultiplier, maxValueMultiplier)\n}\n\nexport const useMinViewportSize = () => {\n  const { size: { height, width } } = useThree()\n\n  const minSize = Math.min(height, width)\n\n  return minSize\n}\n","import React, { useRef, useContext } from 'react'\nimport * as THREE from 'three'\nimport { buildAttributes, setAttributes, positionToArray } from './utils/geometry'\nimport Points from './Points'\nimport { ThemeContext } from 'styled-components'\nimport { useMinViewportSize } from './utils/scaling'\nimport { useFrame } from 'react-three-fiber'\n\nconst viewportRelativeScale = 75\n\nconst Stars: React.FC<{\n  solarSystems: Record<string, SolarSystem>\n}> = ({ solarSystems }) => {\n  const pointsRef = useRef<THREE.Points>()\n\n  const theme = useContext(ThemeContext)\n\n  const minViewportSize = useMinViewportSize()\n\n  useFrame(() => {\n    if (!pointsRef.current) {\n      return\n    }\n\n    const colorMaxSec = new THREE.Color(theme.colorMaxSec)\n    const solarSystemArray = Object.values(solarSystems)\n\n    const count = solarSystemArray.length\n\n    const systemSize = minViewportSize / viewportRelativeScale\n\n    const { positions, colors, scales } = buildAttributes(count)\n\n    for (let index = 0; index < count; index++) {\n      const solarSystem = solarSystemArray[index]\n\n      positionToArray(solarSystem, positions, index)\n\n      new THREE.Color(theme.colorMinSec).lerp(colorMaxSec, solarSystem.security).toArray(colors, index * 3)\n\n      scales[index] = systemSize * solarSystem.radius\n    }\n\n    setAttributes(pointsRef.current.geometry as THREE.BufferGeometry, positions, colors, scales)\n  })\n\n  return <Points ref={pointsRef} />\n}\n\nexport default React.memo(Stars)\n","import React, { useRef, useContext } from 'react'\nimport { useFrame } from 'react-three-fiber'\nimport * as THREE from 'three'\nimport differenceInMilliseconds from 'date-fns/differenceInMilliseconds'\nimport { ageMultiplier, useMinViewportSize } from './utils/scaling'\nimport { buildAttributes, setAttributes, positionToArray } from './utils/geometry'\nimport Points from './Points'\nimport { ThemeContext } from 'styled-components'\n\nconst Flares: React.FC<{\n  solarSystems: Record<string, SolarSystem>\n  killmails: React.MutableRefObject<Killmail[]>\n}> = ({ solarSystems, killmails }) => {\n  const pointsRef = useRef<THREE.Points>()\n\n  const theme = useContext(ThemeContext)\n\n  const minViewportSize = useMinViewportSize()\n\n  useFrame(() => {\n    if (!killmails.current || !pointsRef.current) {\n      return\n    }\n\n    const count = killmails.current.length\n\n    const now = new Date()\n    const baseFlareSize = minViewportSize / 8\n    const colorFlare = new THREE.Color(theme.flare)\n\n    const { positions, colors, scales } = buildAttributes(count)\n\n    for (let index = 0; index < killmails.current.length; index++) {\n      const { receivedAt, solarSystemId, scaledValue } = killmails.current[index]\n\n      const solarSystem = solarSystems[solarSystemId] || {}\n\n      const age = differenceInMilliseconds(now, receivedAt)\n      scales[index] = baseFlareSize * scaledValue * ageMultiplier(age, scaledValue)\n\n      positionToArray(solarSystem, positions, index)\n\n      colorFlare.toArray(colors, index * 3)\n    }\n\n    setAttributes(pointsRef.current.geometry as THREE.BufferGeometry, positions, colors, scales)\n  })\n\n  return <Points ref={pointsRef} />\n}\n\nexport default React.memo(Flares)\n","import React, { useContext, useEffect } from 'react'\nimport styled from 'styled-components'\nimport { ageMultiplier, killmailFullyVisibleMs } from './utils/scaling'\nimport { animated, useSpring, OpaqueInterpolation } from 'react-spring'\nimport differenceInMilliseconds from 'date-fns/differenceInMilliseconds'\nimport { ThemeContext } from 'styled-components'\n\nconst TickerContainer = styled.div`\n  overflow: hidden;\n  max-height: calc(100vh - ${({ theme }) => theme.unit}px);\n  display: flex;\n  flex-flow: column;\n`\n\nconst EntryContainer = styled(animated.div)`\n  display: grid;\n  grid-template-areas: \"ship character corporation alliance\";\n  grid-auto-columns: ${({ theme }) => theme.unit}px;\n  grid-auto-rows: ${({ theme }) => theme.unit}px;\n  gap: ${({ theme }) => theme.gapSize}px;\n  padding-bottom: ${({ theme }) => theme.gapSize}px;\n`\n\nconst ImageLink = styled.a<{ area: string }>`\n  grid-area: ${({ area }) => area};\n  text-decoration: none;\n`\n\nconst Image: React.FC<{\n  src: string\n  area: string\n  height: OpaqueInterpolation<any>\n  href?: string,\n  size: number\n}> = ({ src, area, href, height, size }) => {\n  return <ImageLink href={href} area={area} target='_blank'>\n    <animated.img\n      src={`${src}?size=${size}`}\n      style={{ height, width: size }}\n      alt=''\n    />\n  </ImageLink>\n}\n\nconst animationStepNormal = 1000\nconst animationStepFast = 250\n\nconst KillmailEntry: React.FC<{\n  killmail: Killmail\n}> = React.memo(({ killmail }) => {\n  const { unit } = useContext(ThemeContext)\n  const { characterId, corporationId, allianceId, shipTypeId, url, receivedAt, scaledValue } = killmail\n\n  const [{ height, paddingBottom, opacity }, set] = useSpring(() => ({ opacity: 0, height: 0, paddingBottom: 0 }))\n\n  useEffect(() => {\n    const height = unit\n    const paddingBottom = unit / 8\n    const animate = () => {\n      const age = differenceInMilliseconds(new Date(), receivedAt)\n      if (age < killmailFullyVisibleMs) {\n        set({ opacity: 1, height, paddingBottom, config: { duration: animationStepFast } })\n      } else {\n        const opacity = ageMultiplier(age, scaledValue)\n        if (opacity > 0.1) {\n          set({ opacity, height, paddingBottom, config: { duration: animationStepNormal } })\n        } else {\n          set({ opacity: 0, height: 0, paddingBottom: 0, config: { duration: animationStepFast } })\n        }\n      }\n    }\n\n    const interval = setInterval(animate, animationStepNormal)\n    animate()\n    return () => clearInterval(interval)\n  }, [set, receivedAt, scaledValue, unit])\n\n  return <EntryContainer style={{ opacity, paddingBottom, gridAutoRows: height }}>\n    {shipTypeId && <Image\n      src={`https://images.evetech.net/types/${shipTypeId}/render`}\n      area='ship'\n      height={height}\n      href={url}\n      size={unit}\n    />}\n    {characterId && <Image\n      src={`https://images.evetech.net/characters/${characterId}/portrait`}\n      area='character'\n      height={height}\n      href={`https://zkillboard.com/character/${characterId}/`}\n      size={unit}\n    />}\n    {corporationId && <Image\n      src={`https://images.evetech.net/corporations/${corporationId}/logo`}\n      area='corporation'\n      height={height}\n      href={`https://zkillboard.com/corporation/${corporationId}/`}\n      size={unit}\n    />}\n    {allianceId && <Image\n      src={`https://images.evetech.net/alliances/${allianceId}/logo`}\n      area='alliance'\n      height={height}\n      href={`https://zkillboard.com/alliance/${allianceId}/`}\n      size={unit}\n    />}\n  </EntryContainer>\n})\n\nconst KillmailTicker: React.FC<{\n  killmails: Killmail[]\n}> = ({ killmails }) => {\n  const entries = killmails.map(km => <KillmailEntry killmail={km} key={km.id} />)\n\n  return <TickerContainer>\n    {entries}\n  </TickerContainer>\n}\n\nexport default KillmailTicker\n","import create from 'zustand'\n\nexport enum CameraMode {\n  full,\n  follow\n}\n\ntype State = {\n  cameraMode: CameraMode,\n  setCameraMode: (mode: CameraMode) => void\n}\n\nexport const useConfiguration = create<State>(set => ({\n  cameraMode: CameraMode.full,\n  setCameraMode: (mode) => set({ cameraMode: mode })\n}))\n","import differenceInMilliseconds from 'date-fns/differenceInMilliseconds'\nimport { useCallback, useEffect } from 'react'\nimport create from 'zustand'\n\nconst normalIntervalBetweenPingsMs = 15 * 1000\nconst checkInterval = 5 * 1000\n\ntype State = {\n  connected: boolean,\n  pingReceived?: Date,\n  receivePing: () => void,\n  checkConnection: () => void\n}\n\nexport const useConnection = create<State>(set => ({\n  connected: false,\n  pingReceived: undefined,\n  receivePing: () => set({ connected: true, pingReceived: new Date() }),\n  checkConnection: () => set(({ pingReceived }) => {\n    const connected = pingReceived ? differenceInMilliseconds(new Date(), pingReceived) < normalIntervalBetweenPingsMs : false\n    return { connected }\n  })\n}))\n\nexport const useConnectionStatus = () => {\n  const checkConnection = useConnection(useCallback(state => state.checkConnection, []))\n\n  useEffect(() => {\n    const interval = setInterval(checkConnection, checkInterval)\n    return () => clearInterval(interval)\n  }, [checkConnection])\n}\n","import differenceInMilliseconds from 'date-fns/differenceInMilliseconds'\nimport { useCallback, useEffect } from 'react'\nimport pickBy from 'lodash/pickBy'\nimport create from 'zustand'\nimport parseISO from 'date-fns/parseISO'\nimport { scaleValue } from '../utils/scaling'\nimport { useConnection } from './connection'\n\nexport const normalKillmailAgeMs = 45 * 1000\nconst trimIntervalMs = 5 * 1000\n\ntype WebsocketStatusMessage = {\n  action: 'tqStatus'\n  tqStatus: string\n  tqCount: string\n  kills: string\n}\n\ntype WebsocketKillmail = {\n  killmail_id: number\n  killmail_time: string\n  solar_system_id: number\n  victim: {\n    alliance_id?: number\n    character_id: number\n    corporation_id: number\n    ship_type_id: number\n    position: {\n      x: number,\n      y: number,\n      z: number\n    }\n  }\n  zkb: {\n    totalValue: number\n    fittedValue: number\n    locationID: number\n    npc: boolean\n    awox: boolean\n    solo: boolean\n    url: string\n  }\n}\n\ntype WebsocketMessage = WebsocketKillmail | WebsocketStatusMessage\n\ntype State = {\n  killmails: Record<string, Killmail>,\n  receiveKillmail: (killmail: Killmail) => void,\n  trimKillmails: () => void\n}\n\nconst shouldKeep = (now: Date, killmail: Killmail) => {\n  const { scaledValue, receivedAt } = killmail\n  const age = differenceInMilliseconds(now, receivedAt)\n  return age < normalKillmailAgeMs * scaledValue\n}\n\nconst subscribeMessage = (channel: string) => JSON.stringify({\n  \"action\": \"sub\",\n  \"channel\": channel\n})\n\nconst parseKillmail = (raw: WebsocketKillmail): Killmail => {\n  const { killmail_id, killmail_time, victim, solar_system_id, zkb } = raw\n  const { character_id, corporation_id, alliance_id, ship_type_id } = victim\n  const { url, totalValue } = zkb\n  const time = parseISO(killmail_time)\n\n  return {\n    id: killmail_id,\n    time,\n    receivedAt: new Date(),\n    characterId: character_id,\n    corporationId: corporation_id,\n    allianceId: alliance_id,\n    shipTypeId: ship_type_id,\n    solarSystemId: solar_system_id,\n    url,\n    totalValue,\n    scaledValue: scaleValue(totalValue)\n  }\n}\n\nexport const useKillmails = create<State>(set => ({\n  killmails: {},\n  receiveKillmail: (killmail) => { set(state => ({ killmails: { ...state.killmails, [killmail.id]: killmail } })) },\n  trimKillmails: () => {\n    const shouldKeepNow = shouldKeep.bind(undefined, new Date())\n    set(state => ({ killmails: pickBy(state.killmails, shouldKeepNow) }))\n  }\n}))\n\nexport const useKillmailMonitor = (sourceUrl: string): void => {\n  const receivePing = useConnection(useCallback(state => state.receivePing, []))\n  const trimKillmails = useKillmails(useCallback(state => state.trimKillmails, []))\n  const receiveKillmail = useKillmails(useCallback(state => state.receiveKillmail, []))\n\n  useEffect(() => {\n    const interval = setInterval(trimKillmails, trimIntervalMs)\n    return () => clearInterval(interval)\n  }, [trimKillmails])\n\n  useEffect(() => {\n    const connection = new WebSocket(sourceUrl)\n\n    connection.onopen = () => {\n      connection.send(subscribeMessage('killstream'))\n      connection.send(subscribeMessage('public'))\n    }\n\n    connection.onmessage = (e) => {\n      const parsed: WebsocketMessage = JSON.parse(e.data)\n\n      if ('killmail_id' in parsed) {\n        receiveKillmail(parseKillmail(parsed))\n      } else if ('tqStatus' in parsed) {\n        receivePing()\n      } else {\n        console.error(parsed)\n      }\n    }\n\n    connection.onclose = (e) => {\n      console.error(e)\n    }\n\n    return () => connection.close()\n  }, [sourceUrl, receiveKillmail, receivePing])\n}\n","import create from 'zustand'\nimport reduce from 'lodash/reduce'\nimport clamp from 'lodash/clamp'\nimport { useEffect } from 'react'\n\ninterface RawSolarSystem {\n  x: number\n  y: number\n  z: number\n  r: number\n  s: number\n  n: string\n  p: number\n}\n\ninterface RawRegion {\n  x: number\n  y: number\n  z: number\n  n: string\n}\n\ntype UniverseApiResponse = {\n  systems: Record<string, RawSolarSystem>,\n  regions: Record<string, RawRegion>\n}\n\ntype State = {\n  systems: Record<string, SolarSystem>,\n  regions: Record<string, Region>,\n  loaded: boolean,\n  receive: (data: UniverseApiResponse) => void\n}\n\nexport const useSolarSystems = create<State>(set => ({\n  systems: {},\n  regions: {},\n  loaded: false,\n  receive: (data: UniverseApiResponse) => {\n    const regions = reduce(data.regions, (state, region, id) => {\n      const { x, y, z, n } = region\n      state[id] = {\n        id: parseInt(id),\n        x,\n        y: z,\n        z: y,\n        name: n\n      }\n      return state\n    }, {} as Record<string, Region>)\n\n    const systems = reduce(data.systems, (state, system, id) => {\n      const { x, y, z, n, r, s, p } = system\n      state[id] = {\n        id: parseInt(id),\n        x,\n        y: z,\n        z: y,\n        name: n,\n        radius: clamp(r * 100, 0.5, 1.5),\n        security: s,\n        regionId: p\n      }\n      return state\n    }, {} as Record<string, SolarSystem>)\n\n    set({ regions, systems, loaded: true })\n  }\n}))\n\nconst selectLoaded = (state: State) => state.loaded\nconst selectReceive = (state: State) => state.receive\n\nexport const useSolarSystemData = (sourceUrl: string): void => {\n  const loaded = useSolarSystems(selectLoaded)\n  const receive = useSolarSystems(selectReceive)\n\n  useEffect(() => {\n    if (!loaded) {\n      const abortController = new AbortController()\n\n      fetch(sourceUrl, { signal: abortController.signal }).then(res => res.json()).then(receive)\n\n      return () => abortController.abort()\n    }\n  }, [sourceUrl, loaded, receive])\n}\n","import React, { useState, useEffect, useCallback, useRef } from 'react'\nimport styled from 'styled-components'\nimport { useSolarSystems, useKillmails } from './hooks'\nimport { Stats } from 'drei'\nimport random from 'lodash/random'\nimport sample from 'lodash/sample'\nimport { scaleValue } from './utils/scaling'\n\nconst Container = styled.div`\n  color: ${({ theme }) => theme.text};\n  display: flex;\n  flex-flow: column;\n  gap: 1vh;\n`\n\nconst minValue = 10_000\nconst maxValue = 10_000_000_000\n\nlet testId = new Date().getTime()\nconst buildTestKillmail = (value: number, solarSystemId: string) => {\n  testId += 1\n\n  const now = new Date()\n\n  return {\n    id: testId,\n    time: now,\n    receivedAt: now,\n    characterId: 90230071,\n    corporationId: 98076155,\n    allianceId: 99007254,\n    shipTypeId: 22456,\n    solarSystemId: parseInt(solarSystemId),\n    url: 'https://example.com',\n    totalValue: value,\n    scaledValue: scaleValue(value)\n  }\n}\n\nconst DevTools: React.FC<{}> = () => {\n  const statsContainer = useRef(null)\n  const solarSystems = useSolarSystems(useCallback(state => state.systems, []))\n  const [activityInterval, setAcitivtyInterval] = useState(1000)\n  const receiveKillmail = useKillmails(useCallback(state => state.receiveKillmail, []))\n\n  const randomSolarSystemId = useCallback(() => sample(Object.keys(solarSystems)) as string, [solarSystems])\n\n  const [statsOn, setStatsOn] = useState(false)\n\n  const [activityOn, setActivityOn] = useState(false)\n  useEffect(() => {\n    let timeout: number\n\n    if (activityOn) {\n      const randomInterval = () => random(activityInterval * 0.8, activityInterval * 1.2)\n      const activity = () => {\n        const bigKillChance = random(100)\n        const maxAllowed = bigKillChance > 90 ? maxValue : minValue * 1000\n        const id = randomSolarSystemId()\n        const value = random(minValue, maxAllowed)\n        receiveKillmail(buildTestKillmail(value, id))\n        timeout = setTimeout(activity, randomInterval())\n      }\n\n      timeout = setTimeout(activity, randomInterval())\n\n      return () => clearTimeout(timeout)\n    }\n  }, [activityOn, receiveKillmail, randomSolarSystemId, activityInterval])\n\n  const [oneSystemFightOn, setOneSystemFightOn] = useState(false)\n  useEffect(() => {\n    let timeout: number\n\n    if (oneSystemFightOn) {\n      const id = randomSolarSystemId()\n      const randomInterval = () => random(activityInterval * 0.8, activityInterval * 1.2)\n      const activity = () => {\n        const bigKillChance = random(100)\n        const maxAllowed = bigKillChance > 70 ? maxValue : minValue * 1000\n        const value = random(minValue, maxAllowed)\n        receiveKillmail(buildTestKillmail(value, id))\n        timeout = setTimeout(activity, randomInterval())\n      }\n\n      timeout = setTimeout(activity, randomInterval())\n\n      return () => clearTimeout(timeout)\n    }\n  }, [oneSystemFightOn, receiveKillmail, randomSolarSystemId, activityInterval])\n\n  return <Container>\n    <label>\n      <input type='checkbox' checked={statsOn} onChange={() => setStatsOn(!statsOn)} />\n      Show FPS\n    </label>\n    <div ref={statsContainer}></div>\n    {statsOn && <Stats parent={statsContainer} />}\n\n    <label>\n      <input type='range' min={500} max={30000} value={activityInterval} onChange={({ target: { value } }) => setAcitivtyInterval(parseInt(value)) }/>\n      <div>\n        Activity interval: {activityInterval}\n      </div>\n    </label>\n\n    <label>\n      <input type='checkbox' checked={activityOn} onChange={() => setActivityOn(!activityOn)} />\n      Constant random activity\n    </label>\n\n    <label>\n      <input type='checkbox' checked={oneSystemFightOn} onChange={() => setOneSystemFightOn(!oneSystemFightOn)} />\n      One system activity\n    </label>\n\n    <button onClick={() => receiveKillmail(buildTestKillmail(random(maxValue / 10, maxValue), randomSolarSystemId()))}>\n      Big boom\n    </button>\n  </Container>\n}\n\nexport default DevTools\n","import React, { useState, useCallback } from 'react'\nimport styled from 'styled-components'\nimport { useConnection, useConfiguration } from './hooks'\nimport { FontAwesomeIcon, FontAwesomeIconProps } from '@fortawesome/react-fontawesome'\nimport { CameraMode } from './hooks/configuration'\n\nconst Container = styled.div`\n  color: ${({ theme }) => theme.text};\n  display: grid;\n  grid-template-areas: \"fullscreen connection camera\";\n  grid-auto-columns: ${({ theme }) => theme.unit}px;\n  grid-auto-rows: ${({ theme }) => theme.unit}px;\n  gap: ${({ theme }) => theme.gapSize}px;\n  direction: rtl;\n`\n\nconst FlatButton = styled.button<{ area: string }>`\n  color: ${({ theme }) => theme.text};\n  background: transparent;\n  border: none;\n  grid-area: ${({ area }) => area};\n  cursor: ${({ onClick }) => onClick ? 'pointer' : 'default'};\n`\n\nconst FullscreenToggle: React.FC = () => {\n  const [fullScreen, setFullScreen] = useState(false)\n\n  const onClick = () => {\n    if (fullScreen) {\n      document.exitFullscreen().then(() => setFullScreen(false))\n    } else {\n      document.getElementById('root')?.requestFullscreen().then(() => setFullScreen(true))\n    }\n  }\n\n  return <FlatButton type='button' title={fullScreen ? 'Exit fullscreen' : 'Go fullscreen'} onClick={onClick} area='fullscreen'>\n    <FontAwesomeIcon icon={fullScreen ? 'compress-arrows-alt' : 'expand-arrows-alt'} />\n  </FlatButton>\n}\n\nconst ConnectionStatus: React.FC = () => {\n  const connected = useConnection(useCallback(state => state.connected, []))\n\n  return <FlatButton type='button' title={connected ? 'Connected to live feed' : 'Disconnected from live feed!'} area='connection'>\n    <FontAwesomeIcon icon={connected ? 'link' : 'unlink'} />\n  </FlatButton>\n}\n\nconst cameraIcon: Record<CameraMode, FontAwesomeIconProps['icon']> = {\n  [CameraMode.full]: 'globe',\n  [CameraMode.follow]: 'video'\n}\n\nconst nextCameraModes: Record<CameraMode, CameraMode> = {\n  [CameraMode.full]: CameraMode.follow,\n  [CameraMode.follow]: CameraMode.full\n}\n\nconst cameraTitles: Record<CameraMode, string> = {\n  [CameraMode.full]: 'Camera: whole map',\n  [CameraMode.follow]: 'Camera: follow the action'\n}\n\n\nconst CameraStatus: React.FC = () => {\n  const mode = useConfiguration(useCallback(state => state.cameraMode, []))\n  const update = useConfiguration(useCallback(state => state.setCameraMode, []))\n\n  const onClick = () => {\n    const nextCameraMode = nextCameraModes[mode]\n    update(nextCameraMode)\n  }\n\n  return <FlatButton type='button' title={cameraTitles[mode]} onClick={onClick} area='camera'>\n    <FontAwesomeIcon icon={cameraIcon[mode]} />\n  </FlatButton>\n}\n\nconst Controls: React.FC = () => {\n  return <Container>\n    <FullscreenToggle />\n    <ConnectionStatus />\n    <CameraStatus />\n  </Container>\n}\n\nexport default Controls\n","import React, { useCallback, useEffect, useRef } from 'react'\nimport { PerspectiveCamera } from 'drei'\nimport * as THREE from 'three'\nimport { CameraMode } from './hooks/configuration'\nimport { positionToArray, HasPosition } from './utils/geometry'\nimport { useFrame } from 'react-three-fiber'\nimport { ageMultiplier } from './utils/scaling'\nimport differenceInMilliseconds from 'date-fns/differenceInMilliseconds'\nimport { useConfiguration } from './hooks'\n\nconst near = 0.001\nconst far = 100_000\nconst fov = 90\n\nconst defaultPosition = new THREE.Vector3(0, 0, 700)\n\nconst minRadius = defaultPosition.z / 3\nconst movementMultiplier = 0.01\n\nconst lookAtPoints = (points: HasPosition[]): THREE.Vector3 => {\n  const count = points.length\n\n  const positions = new Float32Array(count * 3)\n\n  for (let index = 0; index < count; index++) {\n    positionToArray(points[index], positions, index)\n  }\n\n  const geometry = new THREE.BufferGeometry()\n\n  geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3))\n\n  geometry.computeBoundingSphere()\n  if (geometry.boundingSphere) {\n    const { center, radius } = geometry.boundingSphere\n\n    center.z += Math.max(radius * 1.1, minRadius)\n    return center\n  } else {\n    return defaultPosition\n  }\n}\n\nconst Camera: React.FC<{\n  solarSystems: Record<string, SolarSystem>,\n  killmails: React.MutableRefObject<Killmail[]>\n}> = React.memo(({ solarSystems, killmails }) => {\n  const mode = useConfiguration(useCallback(state => state.cameraMode, []))\n  const ref = useRef<THREE.Camera>()\n  const position = useRef(defaultPosition)\n\n  useEffect(() => {\n    const solarSystemArray = Object.values(solarSystems)\n    if (solarSystemArray.length > 0) {\n      position.current = lookAtPoints(solarSystemArray)\n      if (ref.current) {\n        ref.current.position.lerp(position.current, 1)\n      }\n    }\n  }, [solarSystems])\n\n  useFrame(() => {\n    if (ref.current && position.current) {\n      let target = position.current\n\n      const count = killmails.current?.length || 0\n\n      if (count > 0 && mode === CameraMode.follow) {\n        const now = new Date()\n\n        let maxX = -Infinity\n        let maxY = -Infinity\n        let maxZ = -Infinity\n\n        let minX = +Infinity\n        let minY = +Infinity\n        let minZ = +Infinity\n\n        let totalX = 0\n        let totalY = 0\n        let totalZ = 0\n\n        let totalScale = 0\n\n        for (let index = 0; index < count; index++) {\n          const { solarSystemId, scaledValue, receivedAt } = killmails.current[index]\n          const { x, y, z } = solarSystems[solarSystemId]\n\n          const age = differenceInMilliseconds(now, receivedAt)\n          const scale = scaledValue * ageMultiplier(age, scaledValue)\n\n          if (scale > 0.1) {\n            const scaledX = scale * x\n            const scaledY = scale * y\n            const scaledZ = scale * z\n\n            maxX = Math.max(maxX, x)\n            maxY = Math.max(maxY, y)\n            maxZ = Math.max(maxZ, z)\n\n            minX = Math.min(minX, x)\n            minY = Math.min(minY, y)\n            minZ = Math.min(minZ, z)\n\n            totalX += scaledX\n            totalY += scaledY\n            totalZ += scaledZ\n\n            totalScale += scale\n          }\n        }\n\n        if (totalScale > 0) {\n          const x = totalX / totalScale\n          const y = totalY / totalScale\n          const z = totalZ / totalScale\n\n          const radius = Math.max(\n            maxX - x,\n            maxY - y,\n            maxZ - z,\n            x - minX,\n            y - minY,\n            z - minZ,\n            minRadius\n          )\n\n          target = new THREE.Vector3(x, y, z + radius * 1.1)\n        }\n      }\n\n      ref.current.position.lerp(target, movementMultiplier)\n    }\n  })\n\n  return <>\n    <PerspectiveCamera\n      ref={ref}\n      makeDefault\n      near={near}\n      far={far}\n      fov={fov}\n    />\n  </>\n})\n\nexport default Camera\n","import React from 'react'\nimport { EffectComposer, Bloom, Noise, Vignette } from 'react-postprocessing'\n\nconst doesNotWorkOnAndroidBrowsersAndShouldBeFeatureDetected = 0\n\nconst Effects: React.FC = () => {\n  return <EffectComposer multisampling={doesNotWorkOnAndroidBrowsersAndShouldBeFeatureDetected}>\n    <Bloom luminanceThreshold={0.2} luminanceSmoothing={0.9} intensity={3} />\n    <Noise opacity={0.04} />\n    <Vignette eskil={false} offset={0.1} darkness={1.1} />\n  </EffectComposer>\n}\n\nexport default Effects\n","import React, { useRef, useEffect, useCallback, memo } from 'react'\nimport styled, { createGlobalStyle, ThemeProvider, ThemeContext } from 'styled-components'\nimport reset from 'styled-reset'\nimport { Canvas } from 'react-three-fiber'\nimport { theme } from './utils/theme'\nimport Stars from './Stars'\nimport Flares from './Flares'\nimport KillmailTicker from './KillmailTicker'\nimport { useKillmails, useSolarSystems, useConnectionStatus, useKillmailMonitor, useSolarSystemData } from './hooks'\nimport DevTools from './DevTools'\nimport Controls from './Controls'\nimport Camera from './Camera'\nimport sortBy from 'lodash/sortBy'\nimport reduce from 'lodash/reduce'\nimport Effects from './Effects'\n\nconst devMode = process.env.NODE_ENV === 'development'\n\nconst GlobalStyle = createGlobalStyle`\n  ${reset}\n\n  #root {\n    height: 100vh;\n    background: ${({ theme }) => theme.background};\n    overflow: hidden;\n  }\n\n  canvas {\n    outline: 0;\n  }\n`\n\nconst TopLeft = styled.div`\n  position: absolute;\n  top: 1vmin;\n  left: 1vmin;\n`\n\nconst TopRight = styled.div`\n  position: absolute;\n  top: 1vmin;\n  right: 1vmin;\n`\n\nconst Visuals: React.FC<{\n  solarSystems: Record<string, SolarSystem>\n  killmails: React.MutableRefObject<Killmail[]>\n}> = memo(({ solarSystems, killmails }) => {\n  return <Canvas onCreated={({ gl }) => gl.setClearColor(theme.background)}>\n    <ThemeContext.Provider value={theme}>\n      <ambientLight />\n\n      <Stars solarSystems={solarSystems} />\n      <Flares solarSystems={solarSystems} killmails={killmails} />\n\n      <Camera solarSystems={solarSystems} killmails={killmails} />\n\n      <Effects />\n    </ThemeContext.Provider>\n  </Canvas>\n})\n\nconst App: React.FC<{}> = () => {\n  useKillmailMonitor('wss://zkillboard.com/websocket/')\n  useSolarSystemData(process.env.PUBLIC_URL + '/data/universe.json')\n  useConnectionStatus()\n\n  const killmailsRef = useRef<Killmail[]>([])\n\n  const solarSystems = useSolarSystems(useCallback(state => state.systems, []))\n\n  const killmails = useKillmails(useCallback(state => {\n    const inCurrentSystems = reduce(state.killmails, (arr, km) => {\n      if (solarSystems[km.solarSystemId]) {\n        arr.push(km)\n      }\n      return arr\n    }, [] as Killmail[])\n    return sortBy(inCurrentSystems, 'receivedAt').reverse()\n  }, [solarSystems]))\n\n  useEffect(() => {\n    killmailsRef.current = killmails\n  }, [killmails])\n\n  return <ThemeProvider theme={theme}>\n    <GlobalStyle />\n\n    <Visuals solarSystems={solarSystems} killmails={killmailsRef} />\n\n    <TopLeft>\n      <KillmailTicker killmails={killmails} />\n    </TopLeft>\n\n    <TopRight>\n      <Controls />\n      {devMode && <DevTools />}\n    </TopRight>\n  </ThemeProvider>\n}\n\nexport default App;\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCompressArrowsAlt, faExpandArrowsAlt, faLink, faUnlink, faVideo, faGlobe\n} from '@fortawesome/free-solid-svg-icons'\n\nlibrary.add(faCompressArrowsAlt, faExpandArrowsAlt, faLink, faUnlink, faVideo, faGlobe)\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport './utils/fontawesome'\n\nconst render = (Component: React.ComponentType<{}>)=> {\n  ReactDOM.render(\n    <React.StrictMode>\n      <Component />\n    </React.StrictMode>,\n    document.getElementById('root')\n  )\n}\n\nrender(App)\n\nif (module.hot) {\n  module.hot.accept('./App', () => {\n    const NextApp = require('./App').default\n    console.clear()\n    render(NextApp)\n  })\n}\n"],"sourceRoot":""}