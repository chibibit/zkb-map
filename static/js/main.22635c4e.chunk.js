(this["webpackJsonpzkb-map"]=this["webpackJsonpzkb-map"]||[]).push([[0],{188:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(67),c=r.n(o),i=r(11),l=r(3),s=r(5),u=r(81),f=r(73),m=r(68),d=r.n(m),p=r(1),v=r(7),b=function(e){if(e<500)return p.MathUtils.smoothstep(e,0,500);var t=p.MathUtils.smoothstep(e,500,6e4)-1;return Math.pow(t,4)},h=function(e){var t=p.MathUtils.clamp(e,1e4,1e11);return p.MathUtils.mapLinear(t,1e4,1e11,.5,15)},g=function(){var e=Object(v.d)().size,t=e.height,r=e.width;return Math.min(t,r)},E=JSON.stringify({action:"sub",channel:"killstream"});function y(e,t){switch(t.type){case"RECEIVE_WEBSOCKET":var r=t.payload,n=r.killmail_id,a=r.killmail_time,o=r.victim,c=r.solar_system_id,i=r.zkb,l={id:n,time:Object(u.a)(a),receivedAt:new Date,characterId:o.character_id,corporationId:o.corporation_id,allianceId:o.alliance_id,shipTypeId:o.ship_type_id,solarSystemId:c,url:i.url,totalValue:i.totalValue,scaledValue:h(i.totalValue)};return d()([l].concat(Object(s.a)(e)),"id");case"DECAY":var m=new Date;return e.filter((function(e){return Object(f.a)(m,e.receivedAt)<60}));default:return e}}var O=r(4),j=r(74),w=r(78);Object(v.b)({OrbitControls:w.a});var x=function(){var e=Object(v.d)(),t=e.camera,r=e.gl.domElement,o=Object(n.useRef)();return Object(v.c)((function(e){var t;return null===(t=o.current)||void 0===t?void 0:t.update()})),a.a.createElement("orbitControls",{ref:o,args:[t,r]})},C={background:"#060606",colorMaxSec:"#2A9FD6",colorMinSec:"#E6E6E6",flare:"#E60000",text:"#E6E6E6"},k=a.a.createContext(C),S=function(e){return{positions:new Float32Array(3*e),colors:new Float32Array(3*e),scales:new Float32Array(e)}},z=function(e,t,r,n){e.setAttribute("position",new p.BufferAttribute(t,3)),e.setAttribute("flareColor",new p.BufferAttribute(r,3)),e.setAttribute("size",new p.BufferAttribute(n,1)),e.attributes.position.needsUpdate=!0,e.attributes.flareColor.needsUpdate=!0,e.attributes.size.needsUpdate=!0},A=new p.Vector3,_=function(e,t,r){var n=e.x,a=e.y,o=e.z;A.x=n,A.y=a,A.z=o,A.toArray(t,3*r)},I=r(79),M=r.n(I),V=(new p.TextureLoader).load(M.a),T={color:{value:new p.Color},pointTexture:{value:V}},U=Object(n.forwardRef)((function(e,t){return a.a.createElement("points",{ref:t},a.a.createElement("bufferGeometry",{attach:"geometry"}),a.a.createElement("shaderMaterial",{uniforms:T,vertexShader:"\n  attribute float size;\n  attribute vec3 flareColor;\n\n  varying vec3 vColor;\n\n  void main() {\n    vColor = flareColor;\n    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n    gl_PointSize = size * (300.0 / -mvPosition.z);\n    gl_Position = projectionMatrix * mvPosition;\n  }\n",fragmentShader:"\n  uniform vec3 color;\n  uniform sampler2D pointTexture;\n\n  varying vec3 vColor;\n\n  void main() {\n    gl_FragColor = vec4(color * vColor, 1.0);\n    gl_FragColor = gl_FragColor * texture2D( pointTexture, gl_PointCoord );\n  }\n",blending:p.AdditiveBlending,depthTest:!1,transparent:!0,attach:"material"}))})),D=a.a.memo((function(e){var t=e.solarSystems,r=Object(n.useRef)(),o=Object(n.useContext)(k),c=g();return Object(n.useLayoutEffect)((function(){if(r.current){for(var e=new p.Color(o.colorMaxSec),n=t.length,a=c/90,i=S(n),l=i.positions,s=i.colors,u=i.scales,f=0;f<n;f++){var m=t[f];_(m,l,f),new p.Color(o.colorMinSec).lerp(e,m.security).toArray(s,3*f),u[f]=a}z(r.current.geometry,l,s,u)}}),[t,t.length,o,c]),a.a.createElement(U,{ref:r})})),R=r(32),B=a.a.memo((function(e){var t=e.solarSystems,r=e.killmails,o=Object(n.useRef)(),c=Object(n.useContext)(k),i=g();return Object(v.c)((function(){if(r.current&&o.current){for(var e=r.current.length,n=new Date,a=i/5,l=new p.Color(c.flare),s=S(e),u=s.positions,f=s.colors,m=s.scales,d=0;d<r.current.length;d++){var v=r.current[d],h=v.receivedAt,g=v.solarSystemId,E=v.scaledValue,y=t[g]||{},O=Object(R.a)(n,h);m[d]=a*E*b(O),_(y,u,d),l.toArray(f,3*d)}z(o.current.geometry,u,f,m)}})),a.a.createElement(U,{ref:o})})),F=r(80),P=r.n(F),J=r(33),L=r.n(J);function W(){var e=Object(i.a)(["\n  grid-area: ",";\n  text-decoration: none;\n"]);return W=function(){return e},e}function K(){var e=Object(i.a)(["\n  grid-area: data;\n  color: ",";\n"]);return K=function(){return e},e}function N(){var e=Object(i.a)(['\n  display: grid;\n  grid-template-areas: "ship character corporation alliance"\n                       "ship data      data        data";\n  grid-template-columns: ',"px ","px ","px 1fr;\n  grid-template-rows: repeat(2, ","px);\n  grid-gap: ","px;\n  animation: "," ","s linear;\n"]);return N=function(){return e},e}function Y(){var e=Object(i.a)(["\n  position: absolute;\n  top: ","px;\n  left: ","px;\n  overflow: hidden;\n  max-height: calc(100vh - ","px);\n"]);return Y=function(){return e},e}function G(){var e=Object(i.a)(["\n  0% { opacity: 0; }\n  0.5% { opacity: 1; }\n  10% { opacity: 0.9; }\n  50% { opacity: 0; }\n  100% { opacity: 0; }\n"]);return G=function(){return e},e}var q=Object(O.d)(G()),H=O.c.div(Y(),16,16,32),Q=O.c.div(N(),64,32,32,32,4,q,120),X=O.c.div(K(),C.text),Z=O.c.a(W(),(function(e){return e.area})),$=function(e){var t=e.src,r=e.area,n=e.size,o=e.href;return a.a.createElement(Z,{href:o,area:r,target:"_blank"},a.a.createElement("img",{src:"".concat(t,"?size=").concat(n),style:{height:n,width:n},alt:""}))},ee=function(e){var t,r=e.killmail,n=e.solarSystem.name,o=r.characterId,c=r.corporationId,i=r.allianceId,l=r.shipTypeId,s=r.totalValue,u=r.url;return a.a.createElement(Q,null,l&&a.a.createElement($,{src:"https://images.evetech.net/types/".concat(l,"/render"),area:"ship",size:64,href:u}),o&&a.a.createElement($,{src:"https://images.evetech.net/characters/".concat(o,"/portrait"),area:"character",size:32,href:"https://zkillboard.com/character/".concat(o,"/")}),c&&a.a.createElement($,{src:"https://images.evetech.net/corporations/".concat(c,"/logo"),area:"corporation",size:32,href:"https://zkillboard.com/corporation/".concat(c,"/")}),i&&a.a.createElement($,{src:"https://images.evetech.net/alliances/".concat(i,"/logo"),area:"alliance",size:32,href:"https://zkillboard.com/alliance/".concat(i,"/")}),a.a.createElement(X,null,(t=s)>5e8?"".concat(L()(t/1e9,1),"b"):t>5e5?"".concat(L()(t/1e6,1),"m"):"".concat(L()(t/1e3,1),"k")," @ ",n))},te=function(e){var t=e.killmails,r=e.solarSystems,n=t.map((function(e){var t=e.id,n=e.solarSystemId,o=r[n];return o?a.a.createElement(ee,{killmail:e,solarSystem:o,key:t}):null}));return a.a.createElement(H,null,n)};function re(){var e=Object(i.a)(["\n  ","\n\n  #root {\n    height: 100vh;\n    background: ",";\n    overflow: hidden;\n  }\n"]);return re=function(){return e},e}var ne,ae=Object(O.a)(re(),j.a,C.background),oe={position:new p.Vector3(0,0,1e3),near:.001,far:1e4};ne=function(){var e=function(e){var t=e.sourceUrl,r=Object(n.useReducer)(y,[]),a=Object(l.a)(r,2),o=a[0],c=a[1];return Object(n.useEffect)((function(){var e=setInterval((function(){return c({type:"DECAY"})}),1e4);return function(){return clearInterval(e)}}),[c]),Object(n.useEffect)((function(){var e=new WebSocket(t);return e.onopen=function(){e.send(E)},e.onmessage=function(e){var t=JSON.parse(e.data);c({type:"RECEIVE_WEBSOCKET",payload:t})},function(){return e.close()}}),[t,c]),o}({sourceUrl:"wss://zkillboard.com/websocket/"}),t=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),r=t[0],a=t[1];return Object(n.useEffect)((function(){fetch("data/solarSystems.json").then((function(e){return e.json()})).then((function(e){var t=Object.entries(e).map((function(e){var t=Object(l.a)(e,2),r=t[0],n=t[1],a=n.x,o=n.y,c=n.z,i=n.r,s=n.s,u=n.n;return{id:parseInt(r),x:a,y:c,z:o,name:u,radius:i,security:s}}));a(t)}))}),[]),r}(),r=Object(n.useRef)([]),o=Object(n.useMemo)((function(){return P()(t,"id")}),[t]);return Object(n.useEffect)((function(){r.current=e}),[e]),a.a.createElement(k.Provider,{value:C},a.a.createElement(ae,null),a.a.createElement(v.a,{camera:oe,onCreated:function(e){return e.gl.setClearColor(C.background)}},a.a.createElement("ambientLight",null),a.a.createElement(D,{solarSystems:t}),a.a.createElement(B,{solarSystems:o,killmails:r}),a.a.createElement(x,null)),a.a.createElement(te,{killmails:e,solarSystems:o}))},c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(ne,null)),document.getElementById("root"))},79:function(e,t,r){e.exports=r.p+"static/media/glow.3b6b0c75.png"},82:function(e,t,r){e.exports=r(188)}},[[82,1,2]]]);
//# sourceMappingURL=main.22635c4e.chunk.js.map